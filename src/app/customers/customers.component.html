<div class="dashboard-flex">
  <div class="main-content" [ngClass]="{ 'chat-open': isChatOpen, 'chat-closed': !isChatOpen }">
    <div class="tabs-center">
      <app-tabs></app-tabs>
    </div>

    <div *ngIf="loading">
      <app-loader></app-loader>
    </div>

    <div *ngIf="!loading">
    <div class="grid-container">
      <ag-grid-angular
        class="ag-theme-quartz"
        style="width: auto; min-width: 1500px;"
        [style.height.px]="(rowData?.length || 300) * 100"
        [rowData]="rowData"
        [columnDefs]="columnDefs"
        [gridOptions]="{ rowHeight: 50, headerHeight: 50 }"
        (gridReady)="onGridReady($event)">
      </ag-grid-angular>
    </div>
    </div>
  </div>

  <div class="chat-sidebar" [ngClass]="{ 'chat-open': isChatOpen, 'chat-closed': !isChatOpen }">
    <div class="chat-header">
      <h3>ðŸ’¬ Chat Support</h3>
      <button class="close-chat-btn" (click)="toggleChat()" title="Close Chat">Ã—</button>
    </div>
    <div class="chat-messages" #chatMessages>
      <div class="message" *ngFor="let message of messages">
        <p [ngClass]="{ user: message.isUser, bot: !message.isUser }">
          {{ message.text }}
        </p>
      </div>
    </div>
    <div class="chat-input-container">
      <input
        type="text"
        class="chat-input"
        [(ngModel)]="currentMessage"
        (keypress)="handleKeyPress($event)"
        placeholder="Type your message..."
      />
      <button class="send-btn" (click)="sendMessage()">Send</button>
    </div>
  </div>
</div>

<!-- Chat Toggle Button (when chat is closed) -->
<button
  class="chat-toggle-btn"
  *ngIf="!isChatOpen"
  (click)="toggleChat()"
  title="Open Chat Support"
>
  ðŸ’¬
</button>
